<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>userInfo.html</title>
    <script src="/WebContent/js/jquery-3.6.0.min.js"></script>
    <style>
        caption {
            text-align: left;
            font-weight: bold;
        }

        #show {
            padding-top: 15px;
        }
    </style>
    <script>
        // DB 데이터 화면에 출력
        $(document).ready(function () {
            $.ajax({
                url: '../getUserListServlet',
                dataType: 'json',
                success: function (result) {
                    let table = $('<table id = "tab"/>').attr('border', '1');
                    table.append(getTitle());

                    for (let obj of result) {
                        let $tr = $('<tr />');
                        let alink = $('<a />').attr('href', '#').html(obj.title);

                        let modifyBtn = $('<button />').html('수정');
                        modifyBtn.clcik(ModifyUser);

                        $tr.append(
                            $('<td />').html(obj.userID),
                            $('<td />').html(obj.name),
                            $('<td />').html(obj.fileName),
                            $('<td />').html(obj.phone),
                            $('<td />').html(modifyBtn)
                        );
                        table.append($tr);
                    }

                    $('#show').append(table);
                },
                error: function (err) {
                    console.log(err);
                }
            });


            // 테이블 타이틀
            function getTitle() {
                let $title = $('<tr />');
                $title.append(
                    $('<th />').html('회원번호'),
                    $('<th />').html('이름'),
                    $('<th />').html('연락처'),
                    $('<th />').html('성별'),
                    $('<th />').html('기능')
                );
                return $title;
            };

            // submit 기능
            $('#frm').submit(function (e) {
                e.preventDefault();
                let frm = document.getElementById('frm');
                let data = new FormData(frm);

                $.ajax({
                    contentType: false,
                    processData: false,
                    url: $('#frm').attr('action'),
                    type: 'post',
                    dataType: 'json',
                    data: data,
                    success: function (result) {
                        console.log(result);
                        window.alert('생성됨.')
                    },
                    error: function (err) {
                        console.log(err);
                        window.alert('안 됨.')
                    }
                });

            });

            // reset 기능
            function inputReset() {

            }

            // 조회 버튼 기능
            function showTable() {

            }

            // 수정 버튼 클릭
            function ModifyUser(e) {
                e.preventDefault();
                let frm = document.getElementById('frm');
                let data = new FormData(frm);

                $.ajax({
                    url: '../modifyUserServlet',
                    type: 'post',
                    data: data,
                    type: 'post',
                    dataType: 'json',
                    success: function (result) {
                        window.alert('수정됨.');
                    },
                    error: function (err) {
                        console.log(err);
                    }

                });
            }


        });
    </script>
</head>

<body>
    <form id='frm' action='../UploadUserServlet' method='post' enctype='multipart/form-data'>

        <table border="1">
            <caption>
                <등록화면>
            </caption>
            <tr>
                <td>사용ID</td>
                <td><input type="text" name="userID" id="userID"></td>
            </tr>
            <tr>
                <td>이름</td>
                <td><input type="text" name="name" id="name"></td>
            </tr>
            <tr>
                <td>비밀번호</td>
                <td><input type="text" name="userPass" id="userPass"></td>
            </tr>
            <tr>
                <td>연락처</td>
                <td><input type="text" name="phone" id="phone"></td>
            </tr>
            <tr>
                <td>성별</td>
                <td>
                    <input type="radio" name="gender" val="man"> 남성 </input>
                    <input type="radio" name="gender" val="woman"> 여성 </input>
                </td>
            </tr>
            <tr>
                <th colspan="2">
                    <input type="submit" val="등록">
                    <input type="reset" val="취소">
                </th>
            </tr>
        </table>

    </form>

    <div id="show"><button id="listshow">조회</button></div>
</body>

</html>